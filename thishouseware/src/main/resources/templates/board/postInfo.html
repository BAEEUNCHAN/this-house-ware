<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/default_layout}"
	layout:fragment="Content">
<head>
<meta charset="UTF-8">
<title></title>
</head>
<body>
	<h3>게시글 정보</h3>
	<table class="table">
		<tr>
			<th>게시판 이름</th>
			<td>[[ ${post.boardTitle} ]]</td>
		</tr>
		<tr>
			<th>게시글 제목</th>
			<td>[[ ${post.title} ]]</td>
		</tr>
		<tr>
			<th>작성자</th>
			<td>[[ ${post.id} ]]
		</tr>
		<tr>
			<th>작성일자</th>
			<td>[[ ${ #dates.format(post.submitDT, "yyyy-MM-dd")} ]]</td>
		</tr>
		<tr>
			<th>내용</th>
			<td height="100px" width="200px">[[ ${post.content} ]]</td>
		</tr>
	</table>

	<button type="button"
		th:onclick="|location.href='@{/board/postList(boardsNo=${post.boardsNo})}'|">목록</button>
	<button type="button"
		th:onclick="|location.href='@{/board/postDelete(postsNo=${post.postsNo}, boardsNo=${post.boardsNo})}'|">삭제</button>

	<!-- 댓글 조회 -->
	<table class="table">
		<thead>
			<tr>
				<th>댓글 번호</th>
				<th>작성자</th>
				<th>작성일자</th>
				<th>내용</th>
			</tr>
		</thead>
		<tbody>
			<th:block th:each="info : ${comments}">
			<tr>
				<td>[[ ${info.commentsNo} ]]</td>
				<td><th:block th:if="${info.id}"
						  th:text="'<관리자> ' + ${info.id}">
					<th:block th:if="${post.id} == ${info.id}"
						  th:text="'<글쓴이> ' + ${info.id}">
					<th:block th:unless="${post.id} != ${info.id}"
				          th:text="${info.id}"></td>
				<td>[[ ${ #dates.format(info.submitDT, "yyyy-MM-dd")} ]]</td>
				<td>[[ ${info.content} ]]</td>
			</tr>
		</tbody>
	</table>

	<!-- 댓글 작성 -->
	<form name="insertForm" th:action="@{/board/postInfo}" method="post">
		<input name="postsNo" type="hidden" th:value="${post.postsNo}">
		<table class="table">
			<tr>
				<th>작성자</th>
				<td><input type="hidden" name="id"
					th:value="${#authentication.principal.empVO.id}">[[${#authentication.principal.empVO.name}]]</td>
			</tr>
			<tr>
				<th>내용</th>
				<td><textarea name="content"></textarea></td>
			</tr>
		</table>
		<button type="submit"
			th:onclick="|location.href='@{/board/postInfo(postsNo=${post.postsNo})}'|">등록</button>
	</form>
	<!-- <button type="button" th:onclick="|location.href='@{/postUpdate(bno=${board.bno})}'|">수정</button> -->
	<!-- <button type="button" th:onclick="|location.href='@{/boardUpdate(bno=${board.bno})}'|">수정</button>
		<button type="button" th:onclick="|location.href='@{/boardList}'|">목록</button>
		<button type="button" th:onclick="|location.href='@{/boardDelete(no=${board.bno})}'|">삭제</button> -->
	<script>
		// submit을 하기 전 내용 확인
		$(insertForm).on('submit', commentInsertHandler);

		function commentInsertHandler(event) {
			event.preventDefault();

			let content = $('form [name="content"]');
			if (content.val() == '') {
				alert('내용이 입력되지 않았습니다.');
				content.focus();
				return;
			}

			alert('댓글이 등록되었습니다.');
			insertForm.submit();
		}
	</script>
</body>
</html>